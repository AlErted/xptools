-------------------------------------------------------------------------------







                 A C 3 D   X - P L A N E   P L U G I N







-------------------------------------------------------------------------------

CHANGE HISTORY:

-------------------------------------------------------------------------------

Version 1.1 11/30/04



	- Support for cockpit quads.

	- Bug fix: ATTR_nocull renamed to ATTR_no_cull

	- Bug fix: Objects are treated as smooth shaded by default.

	- Bug fix: Smooth shading and culling reset at the end of each LOD.

		(Note: this is only needed for older versions of x-plane.)

	



The X-Plane import/export plugin for AC3D (XPlaneSupport.p) is a plugin for

AC3D that supports the reading of X-Plane Object version 7 files.  These 

files should be compatible with all versions of X-Plane  (although some 

features are only supported in version 7.40 and beyond).



This plugin provides both import and export of X-Plane Object 7 files into

and out of AC3D, and also a few useful commands for working with Objects.



This plugin works with AC3D for Windows version 4 and AC3D for Macintosh OS X

version 5.



-------------------------------------------------------------------------------

INSTALLING

-------------------------------------------------------------------------------

Simply copy the AC3D plugin file XPlaneSupport.p into the "plugins" folder for

AC3D while it is not running, then start AC3D.



You'll also want to download the standard suite of plugins from the AC3D

website; this includes two plugins to support reading and writing the .PNG

graphics file format.  (AC3D supports .bmp files by default.)



WARNING: the X-Plane epxorter plugin is not compatible with the Alias Wavefront

OBJ import/export plugin, because they share a similar file name extension.  

Remove the alias wavefront importers (obj_import.p, obj_export.p) from the 

plugins folder before working with this plugin.



-------------------------------------------------------------------------------

USING THE PLUGIN

-------------------------------------------------------------------------------



When the plugin is installed the export menu gains a new option: 

"X-Plane 7 Object File...", and the Import dialog will have a file type

"X-Plane 7 Objerct File (*.obj)" in it.  (Note: if you have the Alias 

Wavefront Object importer plugin installed this may not work.)



To import an object, simply choose import and select your .obj file.  It will

be imported and appear in the main windows.



To export an object, simply pick the export menu item and save your file.



-------------------------------------------------------------------------------

LIMITATIONS

-------------------------------------------------------------------------------

This importer/exporter does not support:



 - Lights.

 - Materials.

 - It will not build quad strips, tri strips, or tri fans.

 - There is not yet a way to preview night lighting inside AC3D.

 - There is no way to access "special" quads such as movies, hard

   surfaces, etc.



-------------------------------------------------------------------------------

TEXTURES AND AC3D

-------------------------------------------------------------------------------



Object 7 files can have only one texture; make sure you use the same texture

for every object in your model.  The easiest way to do this is to select all

objects via the Object Hierarchy window (click on 'World') and then pick your

texture from the Object->Texture submenu.



AC3D requires a plugin to read .png files; it can read .bmp files by default.



When an object file is loaded, the texture will be loaded if it is in the same

directory as the .obj file itself.



Textures are always saved without any relative path information.  For example,

if the texture file for my object is "jetway.bmp", only "jetway" is written to

the OBJ7 file, and the texture must be directly in the "Custom Object Textures"

folder within your custom scenery package.  If you want to specify a texture

in a subfolder for X-Plane, you will have to edit the beginning of your OBJ7

file manually with a text editor; AC3D cannot write out textures in sub-

directories automatically.



For X-Plane 8 users the "object with texture rule" works well.  For X-plane 7 

users:



Because this texture handling is different from X-plane's, you may want to 

keep textures with your objects until you are done editing your object, then

move the bitmap or png file and change the path for your object when you are

ready to package up the object in your custom scenery package.



-------------------------------------------------------------------------------

LEVEL OF DETAIL

-------------------------------------------------------------------------------

When an object has multiple levels of detail, it is imported into AC3D as a 

nested hierarchy of objects, each one having a name "LOD xxxx/yyyy" where

xxxx and yyyy is the range that this version of the object is meant for in

meters.  These objects are then written back out as level-of-detail 

attributes for x-plane on export.  You can edit the names of the objects in

AC3D to change the level of detail distances of your object.  



To get a feel for how this works, try importing the KSBD sample object.  Note

that after import, multiple versions of the object are visible; you may want 

to hide a version of the object (this can be done by right-clicking on an 

object in the hierarchy window and picking 'hide') to reduce clutter on the 

screen.



-------------------------------------------------------------------------------

OTHER ATTRIBUTES

-------------------------------------------------------------------------------

X-Plane objects are by default one-sided and flat-shaded.  The 

importer/exporter correctly handles two-sided and smooth shaded objects in 

AC3D and OBJ7 files.  Two warnings:



 - Two sided polygons are significantly slower than one-sided polygons; only

   set a surface or object to be two-sided when it is necessary.

 - Smooth shading in x-plane currently only works on triangle strips and quad

   strips.  Since the exporter never builds these, smooth-shading is not 

   visbible in x-plane.  For this reason, do not use smooth shading for now.

   

-------------------------------------------------------------------------------

CALCULATE X-PLANE LOD COMMAND

-------------------------------------------------------------------------------



This command attempts to calculate the farthest level of detail distance that

is appropriate for your object, based on it its approximate size.  Select the

entire object and select "Calculate X-Plane LOD" from the tools menu.  A 

message box will suggest an LOD such as "Recommended LOD Distance: 1134 

meters."   This is just a recommendation; you may want to increase or decrease

this  distance for your preferences.



To actually apply the level of detail, create a group around your object with

a name like "LOD xxxx/yyyyy" where xxxx and yyyy are the distances in meters.

If you have multiple top level groups you will have multiple versions of your

object.  Make sure that no two LOD ranges overlap, the first number is smaller

than the second, and that the smallest LOD start at 0.  For example;



- World

   - Group 'jetway_747.obj'

      - Object 'LOD 0.0000/3000.0'

      - Object 'LOD 0.0300/6000.0'



This hierarchy window shows an object with two versions, one visible from 0-3

km and one from 3-6 km.  After 6 km the object will not be drawn, even if the

atmospheric visibility is better than 6 km.



-------------------------------------------------------------------------------

CHANGE TEXTURE COMMAND

-------------------------------------------------------------------------------

You can use the change texture command to change the texture of your object

without disturbing the texturing of each polygon.  In order to do this, the

new texture (the _replacing_ texture) must fully contain the image of the

object's current texture (the _replaced_ texture).  This image of the current

texture cannot be squished, stretched, color adjusted, or rotated in the new

texture.  However, the space in the new image around the old texture can 

contain anything.  The new and old textures must both have (or not have) alpha.



Select the object(s) you want to do the texture replace on and select the

"Change Texture..." command from the tools menu, and pick a .BMP or .PNG file

that will be the new texture.  For every selected object whose texture is

contained in the new texture, two things will happen:



1. That object will now use the new texture as its texture.

2. The texture coordinates of every surface in that object will be adjusted so

that the object's appearance does not change, even though the layout of the

new object is different.



Two example uses of this command:



1. You have a house object with a 256x256 texture, and you want to add some

trees, but you do not have room in the texture to add the tree bitmaps.  You

create a new 512x256 bitmap, with the old 256x256 bitmap on the left side.

Select your house and pick Change Texture and select the new 512x256 bitamp.

All texture coordinates are modified so that the house uses the new bitmap.

You now have the whole right side of the 256x256 bitmap to use for tree 

bitmaps.



2. You have a house object with a 256x256 bitmap, and a car object with a

different 256x256 bitmap.  You want to combine them into a house with a car

parked as one object, but they use different bitmap files.  You create a new

bitmap in photoshop with the house on top, the car on the bottom, that is 256

x512 pixels tall.  You then import both the car and house into AC3D and 

position them where you want.  You select all of these objects and do a

Change Texture to the new 256x512 combined bitmap, and now the house and car

use one big bitmap.  You can then export this new house adn car scene as a

single object with a single bitmap and use it in x-plane.



(This second technique is powerful when you are working with a lot of detail

in an urban setting and you want to reduce the object count to increase 

framerate.)



-------------------------------------------------------------------------------

MAKE TRANSPARENT COMMAND

-------------------------------------------------------------------------------



This command changes the magenta color of a .bmp-based texture into

transparent pixels to simulate what you would see in x-plane.  Select the

object and pick "Make Transparent" from the tools menu.  All textures used

in the selected objects are changed.  This command may only be used on

RGB textures without alpha.  Like X-Plane, this command only converts perfect

matching #FF00FF magenta.



-------------------------------------------------------------------------------

MAKE NIGHT LIGHTING COMMAND

-------------------------------------------------------------------------------



This command attempts to merge the texture of an object with its night 

lighting counterpart to show you what it would look like lit.  Select

an object and pick "Show Night Lighting" from the tools menu.  All textures

used in the selected objects are changed to look like night lighting.



You can use the 'reload texture' command from AC3D's texture menu (under

the object menu) to reload the normal daytime texture.



-------------------------------------------------------------------------------

COCKPIT OBJECT EDITING

-------------------------------------------------------------------------------



The AC3D plugin can load and save cockpit objects.  It requires the following

convensions:



1. Your object must be saved in your ACF folder.



2. You must have a custom panel in the folder cockpit/-PANELS-/panel.png.



3. You can only use quads for the panel texture.



The AC3D plugin will suspend the one-texture-per-object rule when the cockit

panel background is used.  Please note that you must use the ACTUAL panel 

background bitmap and not a copy in another folder.



-------------------------------------------------------------------------------

WARNING MESSAGES

-------------------------------------------------------------------------------



The AC3D may spit out some warning messages when you export an object:



"Warning: 3 objects did not have textures assigned.  You must assign a 

texture to every object for X-Plane output."



	This warning happens when one or more polgon surface is missing a texture.

	X-Plane draws all polygons with textures, so if you don't assign a texture

	and adjust that surface's texture coordinates, you will probably see 

	random junk in x-plane.  Select all objects and pick a texture from the

	Object -> Texture menu to fix this.



"This model uses more than one texture.  You may only use one texture for an 

X-Plane OBJ."



	Not counting a special panel texture for cockpit objects, you can only use

	one texture per X-Plane object.  Pick one texture and assign it to all non-

	panel surfaces to pick this.

	

	WARNING: if you have a texture assigned to line geometry, it must be the

	same textures as polygons have, even though this texture is ignored.



"This model has non-quad surfaces that use the panel texture.  Only quad 

surfaces may use the panel texture."

    

	The new panel texture feature only works with quad geometry.  If you have 

	a surface that doesn't have four sides, then the plugin cannot build the

	appropriate OBJ elements and will signal this error.



With all of these warnings, AC3D will try to select any offending surfaces or

obojects to help you locate the problem.  AC3D may not be able to select all

of the problem areas at once; so it may take repeated exports to diagnose all

problems.  Also, you may need to put AC3D into Surface or Object selection

mode to get a better selection for diagnostic purposes.

