TYPE		:= EXECUTABLE
CFLAGS		:= -include src/Obj/XDefs.h
CXXFLAGS	:= -include src/Obj/XDefs.h
ifeq ($(PLATFORM), Linux)
LDFLAGS		:= -nodefaultlibs -static-libgcc
STDLIBS		:= -Wl,-Bstatic -lstdc++ -lm -lgcc -lgcc_eh -Wl,-Bdynamic -ldl -lpthread -lc -Wl,-Bstatic -lgcc -lgcc_eh
LIBS		:= -Wl,-Bdynamic -lGL -lGLU -Wl,-Bstatic -lbfd -liberty -lsquish -lsqlite3 -lshp -lgeotiff -lCGAL -lproj -lfreetype -ltiff -ljpeg -lpng12 -lz
DEFINES		:= -DUSE_JPEG=1 -DUSE_TIF=1 -DWED=1
include makerules/WED_resources
endif
ifeq ($(PLATFORM), Mingw)
LIBS		:= -lglu32 -lopengl32 -lgdi32 -lole32 -lcomctl32 -lcomdlg32 -luuid -lws2_32 -Wl,-Bstatic -lCGAL -lsquish -lsqlite3 -lshp -lgeotiff -lCGAL -lproj -lfreetype -ltiff -ljpeg -lpng12 -lz
LDFLAGS		:= -Wl,-subsystem,windows
DEFINES		:= -DUSE_JPEG=1 -DUSE_TIF=1 -DWED=1 -D_WIN32_IE=0x0500 -D_WIN32_WINNT=0x0500 -DMINGW_BUILD=1
WIN_RESOURCES := src/WEDResources/WED.rc
endif


COMMON_SRC := \
src/UI/FontMgr.cpp \
src/WEDCore/WED_AppMain.cpp \
src/WEDCore/WED_Application.cpp \
src/WEDCore/WED_PackageMgr.cpp \
src/WEDCore/WED_Package.cpp \
src/WEDCore/WED_Archive.cpp \
src/WEDCore/WED_Buffer.cpp \
src/WEDCore/WED_Document.cpp \
src/WEDCore/WED_EnumSystem.cpp \
src/WEDCore/WED_Errors.cpp \
src/WEDCore/WED_FastBuffer.cpp \
src/WEDCore/WED_LibraryMgr.cpp \
src/WEDCore/WED_Persistent.cpp \
src/WEDCore/WED_Properties.cpp \
src/WEDCore/WED_PropertyHelper.cpp \
src/WEDCore/WED_TexMgr.cpp \
src/WEDCore/WED_UndoLayer.cpp \
src/WEDCore/WED_UndoMgr.cpp \
src/WEDEntities/WED_AirportBeacon.cpp \
src/WEDCore/WED_ResourceMgr.cpp \
src/WEDEntities/WED_AirportBoundary.cpp \
src/WEDEntities/WED_AirportChain.cpp \
src/WEDEntities/WED_Airport.cpp \
src/WEDEntities/WED_AirportNode.cpp \
src/WEDEntities/WED_AirportSign.cpp \
src/WEDEntities/WED_ATCFrequency.cpp \
src/WEDEntities/WED_DrapedOrthophotoBoundary.cpp \
src/WEDEntities/WED_DrapedOrthophoto.cpp \
src/WEDEntities/WED_ExclusionZone.cpp \
src/WEDEntities/WED_TextureBezierNode.cpp \
src/WEDEntities/WED_GISBoundingBox.cpp \
src/WEDEntities/WED_Entity.cpp \
src/WEDEntities/WED_FacadePlacement.cpp \
src/WEDEntities/WED_ForestPlacement.cpp \
src/WEDEntities/WED_GISChain.cpp \
src/WEDEntities/WED_GISComposite.cpp \
src/WEDEntities/WED_GISLine.cpp \
src/WEDEntities/WED_GISLine_Width.cpp\
src/WEDEntities/WED_GISPoint_Bezier.cpp \
src/WEDEntities/WED_GISPoint.cpp \
src/WEDEntities/WED_GISPoint_Heading.cpp\
src/WEDEntities/WED_GISPoint_HeadingWidthLength.cpp \
src/WEDEntities/WED_GISPolygon.cpp \
src/WEDEntities/WED_Group.cpp \
src/WEDEntities/WED_Helipad.cpp \
src/WEDEntities/WED_KeyObjects.cpp \
src/WEDEntities/WED_LightFixture.cpp \
src/WEDEntities/WED_LinePlacement.cpp \
src/WEDEntities/WED_ObjPlacement.cpp \
src/WEDEntities/WED_OverlayImage.cpp \
src/WEDEntities/WED_PolygonPlacement.cpp \
src/WEDEntities/WED_RampPosition.cpp \
src/WEDEntities/WED_Ring.cpp \
src/WEDEntities/WED_Root.cpp \
src/WEDEntities/WED_Runway.cpp \
src/WEDEntities/WED_RunwayNode.cpp \
src/WEDEntities/WED_Sealane.cpp \
src/WEDEntities/WED_Select.cpp \
src/WEDEntities/WED_SimpleBezierBoundaryNode.cpp \
src/WEDEntities/WED_SimpleBoundaryNode.cpp \
src/WEDEntities/WED_StringPlacement.cpp \
src/WEDEntities/WED_Taxiway.cpp \
src/WEDEntities/WED_TextureNode.cpp \
src/WEDEntities/WED_Thing.cpp \
src/WEDEntities/WED_TowerViewpoint.cpp \
src/WEDEntities/WED_Windsock.cpp \
src/WEDImportExport/WED_AptIE.cpp \
src/WEDImportExport/WED_DSFExport.cpp \
src/WEDImportExport/WED_DSFImport.cpp \
src/WEDLibrary/WED_LibraryListAdapter.cpp \
src/WEDLibrary/WED_LibraryPane.cpp \
src/WEDMap/WED_Colors.cpp \
src/WEDMap/WED_CreateLineTool.cpp \
src/WEDMap/WED_CreatePointTool.cpp \
src/WEDMap/WED_CreatePolygonTool.cpp \
src/WEDMap/WED_CreateToolBase.cpp \
src/WEDMap/WED_CreateBoxTool.cpp \
src/WEDMap/WED_HandleToolBase.cpp \
src/WEDMap/WED_Map.cpp \
src/WEDMap/WED_MapBkgnd.cpp \
src/WEDMap/WED_MapLayer.cpp \
src/WEDMap/WED_MapPane.cpp \
src/WEDMap/WED_MapToolNew.cpp \
src/WEDMap/WED_MapZoomerNew.cpp \
src/WEDMap/WED_MarqueeTool.cpp \
src/WEDMap/WED_StructureLayer.cpp \
src/WEDMap/WED_TerraserverLayer.cpp \
src/WEDMap/WED_ToolInfoAdapter.cpp \
src/WEDMap/WED_ToolUtils.cpp \
src/WEDMap/WED_UIMeasurements.cpp \
src/WEDMap/WED_VertexTool.cpp \
src/WEDMap/WED_WorldMapLayer.cpp \
src/WEDMap/WED_DrawUtils.cpp \
src/WEDMap/WED_PreviewLayer.cpp \
src/WEDTCE/WED_TCE.cpp \
src/WEDTCE/WED_TCELayer.cpp \
src/WEDTCE/WED_TCEPane.cpp \
src/WEDTCE/WED_TCEToolAdapter.cpp \
src/WEDTCE/WED_TCEToolNew.cpp \
src/WEDTCE/WED_TCEVertexTool.cpp \
src/WEDProperties/WED_PropertyPane.cpp \
src/WEDProperties/WED_PropertyTable.cpp \
src/WEDWindows/WED_AboutBox.cpp \
src/WEDWindows/WED_DocumentWindow.cpp \
src/WEDWindows/WED_GroupCommands.cpp \
src/WEDWindows/WED_Menus.cpp \
src/WEDWindows/WED_PackageListAdapter.cpp \
src/WEDWindows/WED_PackageStatusPane.cpp \
src/WEDWindows/WED_PackageWindow.cpp \
src/WEDWindows/WED_StartWindow.cpp \
src/GUI/GUI_Broadcaster.cpp \
src/GUI/GUI_Button.cpp \
src/GUI/GUI_ChangeView.cpp \
src/GUI/GUI_Commander.cpp \
src/GUI/GUI_Control.cpp \
src/GUI/GUI_Destroyable.cpp \
src/GUI/GUI_DrawUtils.cpp \
src/GUI/GUI_Fonts.cpp \
src/GUI/GUI_GraphState.cpp \
src/GUI/GUI_Listener.cpp \
src/GUI/GUI_MemoryHog.cpp \
src/GUI/GUI_Packer.cpp \
src/GUI/GUI_PopupButton.cpp \
src/GUI/GUI_Prefs.cpp \
src/GUI/GUI_Resources.cpp \
src/GUI/GUI_ScrollBar.cpp \
src/GUI/GUI_ScrollerPane.cpp \
src/GUI/GUI_SimpleScroller.cpp \
src/GUI/GUI_SimpleTableGeometry.cpp \
src/GUI/GUI_Splitter.cpp \
src/GUI/GUI_TabControl.cpp \
src/GUI/GUI_Table.cpp \
src/GUI/GUI_TabPane.cpp \
src/GUI/GUI_TextField.cpp \
src/GUI/GUI_TextTable.cpp \
src/GUI/GUI_Timer.cpp \
src/GUI/GUI_ToolBar.cpp \
src/GUI/GUI_Window.cpp \
src/GUI/GUI_Pane.cpp \
src/GUI/GUI_Help.cpp \
src/GUI/GUI_Clipboard.cpp \
src/GUI/GUI_Application.cpp \
src/Utils/SQLUtils.cpp \
src/Utils/AssertUtils.cpp \
src/Utils/MemFileUtils.cpp \
src/Utils/FileUtils.cpp \
src/Utils/GISUtils.cpp \
src/Utils/BitmapUtils.cpp \
src/Utils/TexUtils.cpp \
src/Utils/EndianUtils.c \
src/Utils/md5.c \
src/Utils/XChunkyFileUtils.cpp \
src/Utils/CompGeomUtils.cpp \
src/Utils/PolyRasterUtils.cpp \
src/Utils/zip.c \
src/Utils/unzip.c \
src/Utils/XUtils.cpp \
src/Utils/BWImage.cpp \
src/Utils/ObjUtils.cpp \
src/Utils/XFileTwiddle.cpp \
src/Utils/Skeleton.cpp \
src/Utils/perlin.cpp \
src/Utils/MatrixUtils.cpp \
src/Installer/ErrMsg.cpp \
src/Obj/ObjPointPool.cpp \
src/Obj/XObjDefs.cpp \
src/Obj/XObjReadWrite.cpp \
src/Obj/ObjDraw.cpp \
src/Network/Terraserver.cpp \
src/Network/HTTPClient.cpp \
src/Network/XMLObject.cpp \
src/Network/b64.c \
src/DSF/DSFLib.cpp \
src/DSF/DSFLibWrite.cpp \
src/DSF/DSFPointPool.cpp \
src/DSFTools/DSF2Text.cpp \
src/DSFTools/ENV2Overlay.cpp \
src/OGLE/ogle.cpp \
src/XESCore/AptIO.cpp \
libsrc/expat/xmlparse/xmlparse.c \
libsrc/expat/xmltok/xmlrole.c \
libsrc/expat/xmltok/xmltok.c \
src/Env/EnvParser.c \
src/Env/Persistence.cpp \
src/WorldEditor/WED_Assert.cpp \
src/XPWidgets/XPLMGraphics.cpp \
src/Obj/ObjConvert.cpp


WIN32_SRC := \
src/UI/XWin.win.cpp \
src/UI/XWinGL.win.cpp \
src/UI/XWin32DND.cpp \
src/Utils/XFileTwiddle.win.cpp \
src/Utils/PlatformUtils.win.cpp \
src/Network/PCSBSocket.win.cpp \
src/Network/PCSBSocketUDP.win.cpp

POSIX_SRC := \
src/linuxinit/initializer.cpp \
src/linuxinit/minigtk.cpp \
src/UI/XWin.lin.cpp \
src/UI/XWinGL.lin.cpp \
src/UI/XPopup.lin.cpp \
src/UI/xdnd.cpp \
src/Utils/XFileTwiddle.unix.cpp \
src/Utils/PlatformUtils.lin.cpp \
src/GUI/GUI_Laftfont.cpp \
src/Network/PCSBSocket.lin.cpp \
src/Network/PCSBSocketUDP.lin.cpp

ifeq ($(PLATFORM), Linux)
SOURCES := $(COMMON_SRC) $(POSIX_SRC)
endif
ifeq ($(PLATFORM), Mingw)
SOURCES := $(COMMON_SRC) $(WIN32_SRC)
endif

ifeq ($(PLATFORM), Linux)
MESA_HEADERS = -Ilibsrc/linux-specific/mesa/include
endif

INCLUDEPATHS :=\
-Ilibsrc/linux-specific/include \
$(MESA_HEADERS) \
-Ilibsrc/expat/xmlparse \
-Ilibsrc/expat/xmltok \
-Isrc/linuxinit \
-Isrc/WEDTCE \
-Isrc/Env \
-Isrc/DSF \
-Isrc/GUI \
-Isrc/GUI/mmenu \
-Isrc/Interfaces \
-Isrc/Obj \
-Isrc/ObjEdit \
-Isrc/OGLE \
-Isrc/UI \
-Isrc/WEDCore \
-Isrc/WEDDocs \
-Isrc/WEDEntities \
-Isrc/WEDImportExport \
-Isrc/WEDLayers \
-Isrc/WEDLibrary \
-Isrc/WEDMap \
-Isrc/WEDProperties \
-Isrc/WEDResources \
-Isrc/WEDWindows \
-Isrc/WorldEditor \
-Isrc/XPCompat \
-Isrc/XPWidgets \
-Isrc/Utils \
-Isrc/XESCore \
-Isrc/XESTools \
-Isrc/Installer \
-Isrc/Network \
-ISDK/PVR

LIBPATHS :=\
-Llibsrc/linux-specific/lib
